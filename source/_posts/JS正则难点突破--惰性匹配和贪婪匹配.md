---
title: JS正则难点突破--惰性匹配和贪婪匹配
date: 2016-01-17 14:09:55
tags: [JS技巧, 正则, 贪婪匹配, 惰性匹配]
categories: JS
---
在讲贪婪模式和惰性模式之前，先回顾一下JS正则基础：

## 写法基础

①不需要双引号，直接用//包含 => /wehfwue123123/.test();

②反斜杠\表示转义 => /\.jpg$/

③用法基础：.test(str);

<!-- more -->

## 语法

_**①锚点类**_

/^a/ => 以"a"开头

/\.jpg$/ => 以".jpg"结尾

_**②字符类**_

[abc]：a或b或c

[0-9]：一个数字

[a-z]：一个字母

.       ：任意字符

_**③元字符**_

^：在[]里面用表示非，在[]外面用表示开头

\d：[0-9]

\s：空白符

\w：[A-Za-z0-9_]

\D：[^\d]-非数字

\S：非空白符

_**④量词**_

{m,n}：m到n次

元字符表示：

*：{0,}

?：{0,1}

+：{1,}

## 难点：**贪婪模式/惰性模式**

贪婪模式——在匹配成功的前提下，尽可能多的去匹配

惰性模式——在匹配成功的前提下，尽可能少的去匹配

_**解释一：码文并茂**_

使用正则表达式中的贪婪、惰性的量词可以控制表达式匹配过程，我们知道量词？、*、+的意义，可以指定相关模式出现的次数，默认的情况下我们使用的是贪婪量词，它的匹配过程是从整个字符串开始查看，如果不匹配就去掉最后一个，再看看是否匹配，如此循环一直到匹配或字符串空为止，如：

```JavaScript
var s ="abbbaabbbaaabbb1234";

var re1=/.*bbb/g; // *是贪婪量词

re1.test(s);
```

这个匹配过程将从整个字符串开始：

```JavaScript
re1.test("abbbaabbbaaabbb1234"); // false 则去掉最后一个字符4再继续

re1.test("abbbaabbbaaabbb123"); // false 则去掉最后一个字符3再继续

re1.test("abbbaabbbaaabbb12"); // false 则去掉最后一个字符2再继续

re1.test("abbbaabbbaaabbb1"); // false 则去掉最后一个字符1再继续

re1.test("abbbaabbbaaabbb"); // true 结束
```

在贪婪量词的后面加多一个?就变成了惰性量词，它的匹配过程相反，是从前面第一个开始，不匹配则加一个，如此循环直到字符串结束，以上面的为例子。

```JavaScript
var s ="abbbaabbbaaabbb1234";

var re1=/.*?bbb/g; // *?是惰性量词

re1.test(s);
```

它的匹配过程如下：

```JavaScript
re1.test("a"); // false 再加一个

re1.test("ab"); // false 再加一个

re1.test("abb"); // false 再加一个

re1.test("abbb"); // true 匹配了，保存这个结果，再从下一个开始

re1.test("a"); // false 再加一个

re1.test("aa"); // false 再加一个

re1.test("aab"); // false 再加一个

re1.test("aabb"); // false 再加一个

re1.test("aabbb"); // true 匹配了，保存这个结果，再从下一个开始
```

## 小结
默认的贪婪匹配是从后往前匹配，最大长度的匹配，惰性匹配就是在量词后面加个？从字符串的前面开始匹配，最小长度的匹配